(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[278],{9112:function(e,t,a){Promise.resolve().then(a.bind(a,8733))},8698:function(e,t,a){"use strict";a.d(t,{N:function(){return r}});let r=async e=>{let{trx:t}=e;try{let e=await fetch("/api/checkTransactionStatus",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({trx:t})});if(!e.ok)throw Error("Transaction Failed");return await e.json()}catch(e){throw e}}},8733:function(e,t,a){"use strict";a.d(t,{default:function(){return h}});var r=a(7437),s=a(2265),n=a(9064);let l=async()=>{try{let e=await fetch("/api/withdrawOtp",{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Failed to fetch Withdraw OTP ");return await e.json()}catch(e){throw e}};function o(e){let{onOtpFetched:t,setAmount:a,setAddress:o}=e,[i,u]=(0,s.useState)(""),[c,d]=(0,s.useState)(""),h=async e=>{if(e.preventDefault(),i<10){n.ZP.error("Amount must be greater or equal than 10");return}try{let e=await l();!0===e.status?(t(e.otpId),n.ZP.success("OTP fetched successfully")):!1===e.status&&n.ZP.error("Failed to fetch OTP")}catch(e){n.ZP.error("Failed to fetch OTP")}};return(0,r.jsxs)("form",{onSubmit:h,className:"md:w-1/2 w-full flex flex-col gap-5 p-5 border border-gray-500 rounded-2xl",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("label",{htmlFor:"amount",children:"Amount"}),(0,r.jsx)("input",{type:"number",id:"amount",name:"amount",value:i,placeholder:"Minimum $10",onChange:e=>{u(e.target.value),a(e.target.value)},className:"px-3 py-2.5 rounded-md bg-transparent outline-none ring-1 w-full"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("label",{htmlFor:"address",children:"Withdraw Address"}),(0,r.jsx)("input",{type:"text",id:"address",name:"address",placeholder:"USDT (BEP-20)",value:c,onChange:e=>{d(e.target.value),o(e.target.value)},className:"px-3 py-2.5 rounded-md bg-transparent outline-none ring-1 w-full"})]}),(0,r.jsx)("button",{type:"submit",className:"px-5 py-2.5 bg-button-color hover:bg-button-hover-color transition-all duration-200 ease-in-out rounded-md",children:"Get OTP"})]})}let i=async e=>{let{otpId:t,otp:a}=e;try{let e=await fetch("/api/verifyWithdrawOtp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({otpId:t,otp:a})});if(!e.ok)throw Error("Failed to fetch Verify Withdraw Otp ");return await e.json()}catch(e){throw e}},u=async e=>{let{amount:t,address:a}=e;try{let e=await fetch("/api/withdraw",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:t,address:a})});if(!e.ok)throw Error("Withdrawl failed");return await e.json()}catch(e){throw e}};var c=a(8698);function d(e){let{otpId:t,address:a,amount:l}=e,[o,d]=(0,s.useState)(""),[h,f]=(0,s.useState)(!1),m=async e=>{if(e.preventDefault(),f(!0),!t||!o){n.ZP.error("OTP ID and OTP are required");return}try{let e=await i({otpId:t,otp:o});if(!0===e.status){n.ZP.success("OTP verified successfully"),p({address:a,amount:l});return}!1===e.status&&(n.ZP.error("Failed to verify OTP"),f(!1))}catch(e){n.ZP.error("Failed to verify OTP"),f(!1)}},p=async e=>{let{address:t,amount:a}=e;try{let{status:e,transaction_hash:r}=await u({address:t,amount:a});if(!0===e){let t=await w(r);if(!0===t.status){n.ZP.success("Transaction successful"),f(!1);return}!1===e&&n.ZP.error("Transaction failed.",error)}else!1===e&&(n.ZP.error("Withdral failed"),f(!1))}catch(e){n.ZP.error("Failed to perform withdrawal"),f(!1);return}},w=async e=>{try{let t=await (0,c.N)({trx:e});if(!0===t.status){n.ZP.success("Transaction successful"),f(!1);return}if(!1===t.status){if("Failed"===t.reason)return n.ZP.error("Transaction failed.",error),f(!1),null;n.ZP.loading("Wait for some time",{duration:3e3})}await new Promise(e=>setTimeout(e,5e3));let a=await (0,c.N)({trx:e});if(!0===a.status)return n.ZP.success("Transaction successful"),f(!1),window.location.reload("/dashboard/withdrawHistory"),!0===a.status;return n.ZP.error("Transaction failed.",error),f(!1),null}catch(e){return n.ZP.error("Failed to check transaction status"),f(!1),!1}};return(0,r.jsxs)("form",{onSubmit:m,className:"md:w-1/2 w-full flex flex-col gap-5 p-5 border border-gray-500 rounded-2xl md:mt-0 mt-5",children:[(0,r.jsx)("h2",{className:"lg:text-4xl text-3xl lg:font-bold font-semibold gradient-text2 text-center",children:"Submit Your OTP"}),(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("label",{htmlFor:"otp",children:"OTP"}),(0,r.jsx)("input",{type:"number",id:"otp",name:"otp",value:o,onChange:e=>{d(e.target.value)},className:"px-3 py-2.5 rounded-md bg-transparent outline-none ring-1 w-full"})]}),(0,r.jsx)("button",{type:"submit","aria-disabled":h,disabled:h,className:"flex items-center justify-center px-4 py-2.5 bg-button-color rounded-md hover:bg-button-hover-color hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:h?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{viewBox:"0 0 16 16",fill:"currentColor",className:"size-6 mr-2 text-white animate-spin",children:(0,r.jsx)("path",{fill:"currentColor",d:"M8 4.736a.933.933 0 01-.933-.933V1.005a.933.933 0 011.866 0v2.798A.933.933 0 018 4.736zM8 15.577a.583.583 0 01-.583-.583v-2.798a.583.583 0 111.166 0v2.798a.583.583 0 01-.583.583zM5.902 5.24a.875.875 0 01-.758-.437L3.745 2.38a.874.874 0 011.514-.874l1.399 2.423a.874.874 0 01-.756 1.311zM11.498 14.582a.525.525 0 01-.455-.262l-1.399-2.423a.525.525 0 11.909-.525l1.399 2.423a.525.525 0 01-.454.787zM4.365 6.718a.813.813 0 01-.407-.109L1.535 5.21a.817.817 0 01.816-1.414l2.423 1.399a.817.817 0 01-.408 1.523zM14.057 11.964a.461.461 0 01-.233-.063l-2.423-1.399a.467.467 0 01.466-.808l2.423 1.399a.467.467 0 01-.233.87zM3.803 8.758H1.005a.758.758 0 010-1.516h2.798a.758.758 0 110 1.516zM14.995 8.466h-2.798a.466.466 0 110-.932h2.798a.466.466 0 110 .932zM1.943 12.197a.698.698 0 01-.35-1.305l2.423-1.399a.698.698 0 11.699 1.211l-2.423 1.399a.69.69 0 01-.349.094zM11.635 6.368a.466.466 0 01-.233-.87l2.423-1.399a.466.466 0 11.466.808l-2.423 1.399a.469.469 0 01-.233.063zM4.502 14.699a.64.64 0 01-.555-.962l1.399-2.423a.641.641 0 111.111.641l-1.399 2.423a.64.64 0 01-.556.321zM10.098 4.832a.467.467 0 01-.404-.7l1.399-2.423a.467.467 0 01.808.466l-1.399 2.423a.464.464 0 01-.404.233z"})}),"Submitting..."]}):"Withdraw Now"})]})}function h(){let[e,t]=(0,s.useState)(null),[a,n]=(0,s.useState)(""),[l,i]=(0,s.useState)("");return(0,r.jsxs)("div",{className:"flex md:flex-row flex-col gap-5",children:[(0,r.jsx)(o,{onOtpFetched:e=>{t(e)},setAmount:n,setAddress:i}),(0,r.jsx)(d,{otpId:e,address:l,amount:a})]})}}},function(e){e.O(0,[64,971,117,744],function(){return e(e.s=9112)}),_N_E=e.O()}]);