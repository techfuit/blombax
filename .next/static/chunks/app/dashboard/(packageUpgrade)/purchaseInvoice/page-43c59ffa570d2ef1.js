(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[238],{81648:function(e,t,l){Promise.resolve().then(l.bind(l,29546))},29546:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return d}});var s=l(57437),a=l(2265),r=l(56758),n=l(35289),o=l(66648);let i=async()=>{try{let e=await fetch("/api/purchaseinvoice",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"invoice"})});if(!e.ok)throw Error("Failed to fetch Invoice data");let{data:t}=await e.json();return t}catch(e){throw e}};var c=l(57669);function d(){let{user:e}=(0,c.a)(),[t,l]=(0,a.useState)(null),[d,m]=(0,a.useState)(null),[u,x]=(0,a.useState)(!1),h=(0,a.useRef)(null),p=(0,a.useRef)(null);(0,a.useEffect)(()=>{!async function(){try{let e=await i();l(e)}catch(e){throw Error(e)}}()},[]);let f=(null==t?void 0:t.reduce((e,t)=>e+parseFloat(t.amount),0))||0,b=(0,r.useReactToPrint)({content:()=>h.current,documentTitle:"invoice"}),g=(0,r.useReactToPrint)({content:()=>p.current,documentTitle:"invoice-row",onAfterPrint:()=>x(!1)}),j=e=>{m(e),x(!0),setTimeout(()=>g(),0)};return(0,s.jsxs)("div",{className:"bg-glass-color glassBlur rounded-2xl my-5 pb-5",children:[(0,s.jsxs)("div",{ref:h,className:"print-black",children:[(0,s.jsxs)("div",{className:"flex justify-between sm:gap-5 gap-2 items-center p-5",children:[(0,s.jsx)(o.default,{src:"/DFM Logo Dark Mode.png",alt:"Logo",height:500,width:800,priority:!0,className:"md:h-16 object-contain md:w-48 sm:h-12 sm:w-40 h-10 w-32 "}),(0,s.jsx)("h1",{className:"md:text-5xl sm:text-3xl text-2xl font-semibold text-blue-500",children:"INVOICE"})]}),(0,s.jsx)("div",{className:"pl-5 md:pl-8 py-5 pr-20",children:(0,s.jsxs)("div",{className:"pdf-content",children:[(0,s.jsx)("p",{className:"sm:text-2xl text-xl font-semibold mb-0.5",children:"Invoice To"}),(0,s.jsx)("h2",{className:"sm:text-5xl text-4xl font-bold mb-px",children:(null==e?void 0:e.name)||"Full Name"})]})}),(0,s.jsxs)(n.Z,{title:"Invoices",className:"bg-blue-500 px-5 py-3 rounded-ss-2xl rounded-se-2xl",children:[(0,s.jsxs)("div",{className:"grid grid-cols-4 p-3 border-b border-b-gray-500 lg:w-full w-[1000px] relative print:border-b print:border-b-black",children:[(0,s.jsx)("p",{className:"text-lg font-semibold",children:"Serial"}),(0,s.jsx)("p",{className:"pl-4 text-lg font-semibold",children:"Amount"}),(0,s.jsx)("p",{className:"pl-7 text-lg font-semibold",children:"Package Name"}),(0,s.jsx)("p",{className:"pl-10 text-lg font-semibold",children:"Duration"}),(0,s.jsx)("p",{className:"hide absolute top-3 right-7 text-lg font-semibold",children:"Action"})]}),Array.isArray(t)&&t.length>0?t.map((e,t)=>(0,s.jsxs)("div",{className:"grid grid-cols-4 p-3 border-b border-b-gray-500 lg:w-full w-[1000px] relative print-border",children:[(0,s.jsx)("p",{children:t+1<10?"0".concat(t+1):t+1}),(0,s.jsxs)("p",{className:"pl-5",children:["$",e.amount]}),(0,s.jsx)("p",{className:"pl-8",children:e.package_name}),(0,s.jsx)("p",{className:"pl-12",children:e.duration}),(0,s.jsx)("button",{className:"hide absolute top-3 right-10",onClick:()=>j(e),children:(0,s.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"size-6",children:(0,s.jsx)("path",{d:"M11 14.59V3a1 1 0 012 0v11.59l3.3-3.3a1 1 0 011.4 1.42l-5 5a1 1 0 01-1.4 0l-5-5a1 1 0 011.4-1.42l3.3 3.3zM3 17a1 1 0 012 0v3h14v-3a1 1 0 012 0v3a2 2 0 01-2 2H5a2 2 0 01-2-2v-3z"})})})]},e.id)):(0,s.jsx)("p",{className:"text-center font-medium text-lg mt-2",children:"No data available"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-center sm:gap-5 gap-3",children:[(0,s.jsx)("button",{className:"bg-blue-500 hover:bg-blue-600 text-white sm:text-lg font-bold sm:py-2.5 sm:px-5 px-3 py-2 rounded hide",onClick:b,children:"Download"}),(0,s.jsxs)("div",{className:"sm:px-5 sm:py-2.5 px-3 py-2 sm:text-lg font-bold bg-blue-500 hover:bg-blue-600 rounded-md",children:["Total: ",f]})]})]}),u&&d&&(0,s.jsxs)("div",{ref:p,className:"print-black",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center p-5",children:[(0,s.jsx)(o.default,{src:"/DFM Logo Dark Mode.png",alt:"Logo",height:500,width:800,priority:!0,className:"h-16 object-contain w-48"}),(0,s.jsx)("h1",{className:"md:text-5xl text-4xl font-semibold text-blue-500",children:"INVOICE"})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center pl-8 py-5 pr-20",children:[(0,s.jsxs)("div",{className:"pdf-content",children:[(0,s.jsx)("p",{className:"text-2xl font-semibold mb-0.5",children:"INVOICE TO"}),(0,s.jsx)("h2",{className:"text-5xl font-bold mb-px",children:null==e?void 0:e.name}),(0,s.jsx)("p",{className:"text-xl font-semibold",children:"Bangladesh"})]}),(0,s.jsxs)("div",{className:"pdf-content",children:[(0,s.jsxs)("p",{className:"text-lg font-medium",children:["Invoice# : ",null==d?void 0:d.id]}),(0,s.jsx)("p",{className:"text-lg font-medium",children:null==d?void 0:d.date})]})]}),(0,s.jsxs)(n.Z,{title:"Invoice",className:"bg-blue-500 px-5 py-3 rounded-ss-2xl rounded-se-2xl",children:[(0,s.jsxs)("div",{className:"grid grid-cols-4 p-3 border-b border-b-gray-500 lg:w-full w-[1000px] print:border-b-black print:border-b",children:[(0,s.jsx)("p",{className:"text-lg font-semibold",children:"Serial"}),(0,s.jsx)("p",{className:"ml-5 text-lg font-semibold",children:"Amount"}),(0,s.jsx)("p",{className:"text-center text-lg font-semibold",children:"Package Name"}),(0,s.jsx)("p",{className:"text-end text-lg font-semibold",children:"Duration"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 p-3 border-b border-b-gray-500 lg:w-full w-[1000px] ",children:[(0,s.jsx)("p",{children:d.id}),(0,s.jsx)("p",{className:"ml-5",children:d.amount}),(0,s.jsx)("p",{className:"text-center",children:d.package_name}),(0,s.jsx)("p",{className:"text-end",children:d.duration})]})]})]})]})}},35289:function(e,t,l){"use strict";l.d(t,{Z:function(){return r}});var s=l(57437),a=l(39864);function r(e){let{title:t,children:l,className:r}=e;return(0,s.jsxs)("div",{className:"my-5 overflow-hidden w-full",children:[(0,s.jsx)("div",{className:(0,a.cn)("bg-blue-500 px-5 py-3 rounded-ss-2xl rounded-se-2xl",r),children:(0,s.jsxs)("p",{className:"text-2xl font-medium",children:[t," History "]})}),(0,s.jsx)("div",{className:"min-h-20 bg-base-glass-color rounded-es-2xl rounded-ee-2xl",children:(0,s.jsx)("div",{className:"overflow-hidden h-80",children:(0,s.jsx)("div",{className:"overflow-scroll h-full",children:l})})})]})}l(2265)},57669:function(e,t,l){"use strict";l.d(t,{a:function(){return n}});let s=async()=>{try{let e=await fetch("/api/user",{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok){let t=(await e.json()).error||"Failed to fetch Direct Bonus data";throw Error(t)}let{data:t}=await e.json();return t}catch(e){throw e}};var a=l(2265),r=l(88726);let n=()=>{let[e,t]=(0,a.useState)(null),[l,n]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(async()=>{try{let e=await s();t(e),n(!1)}catch(e){i()}})()},[]);let o=e=>{t(e)},i=()=>{document.cookie="sessionId=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",localStorage.removeItem("rememberMe"),localStorage.removeItem("email"),t(null)};return{user:e,loading:l,login:async(e,t,l)=>{try{let s=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!s.ok){if(!1===s.status)throw Error("Incorrect email or password");throw Error("Login failed")}let{status:a,sessionId:n,data:i}=await s.json();if(!a){r.ZP.error("Login unsuccessful",{duration:2e3});return}o(i),document.cookie="sessionId=".concat(n,"; path=/;"),l?(localStorage.setItem("rememberMe","true"),localStorage.setItem("email",e)):(localStorage.removeItem("rememberMe"),localStorage.removeItem("email")),window.location.href="/dashboard",r.ZP.success("Login successful",{duration:2e3})}catch(e){r.ZP.error(e.message||"Login failed",{duration:2e3})}},logout:async()=>{try{if(!(await fetch("/api/logout",{method:"POST"})).ok)throw Error("Logout failed");i(),window.location.href="/login"}catch(e){r.ZP.error(e.message,{duration:2e3})}}}}},39864:function(e,t,l){"use strict";l.d(t,{cn:function(){return r}});var s=l(44839),a=l(96164);function r(){for(var e=arguments.length,t=Array(e),l=0;l<e;l++)t[l]=arguments[l];return(0,a.m6)((0,s.W)(t))}}},function(e){e.O(0,[868,726,648,758,971,23,744],function(){return e(e.s=81648)}),_N_E=e.O()}]);